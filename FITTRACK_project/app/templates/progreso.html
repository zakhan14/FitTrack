{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Gráfico de Rendimiento</title>
  <script src="https://cdn.jsdelivr.net/npm/echarts@5/dist/echarts.min.js"></script>
  <link rel="icon" href="{% static 'images/logo.png' %}">
  <link rel="stylesheet" href="{% static 'css/progress.css' %}" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
</head>
<body>
  <header class="navbar">
    <div class="navbar-left">
      <a href="{% url 'index' %}" ><h1>FTR</h1></a>
    </div>

    <nav class="navbar-center">
      <a href="{% url 'index' %}">Inicio</a>
      <a href="{% url 'entrenamiento' %}">Entrenamiento</a>
    </nav>

    <div class="navbar-right">
      <a href="{% url 'index' %}" class="btn">Log Out</a>
    </div>
  </header>

  <h2 style="text-align: left; margin-left: 26%;">Introduce tus valores</h2>
  <div id="contenedor-formulario-grafico">
    <form method="post" id="calcForm">
      {% csrf_token %}
      {{ form.as_p }}
      <button type="submit" name="guardar">Guardar nueva medición</button>
      <button type="submit" name="comparar">Comparar</button>
    </form>
    {{ chart_data|json_script:"chart-data" }}
  </div>

  <div id="main" style="width: 100%; max-width: 600px; height: 400px; margin: auto;"></div>

 <script>
  const chartData = JSON.parse(document.getElementById('chart-data').textContent);

  if (chartData.length > 0) {
    const labels = ['Altura (cm)', 'Peso (kg)', 'Grasa (%)', 'Músculo (%)', 'Líquidos (%)'];

    const radarValues = chartData.map(entry => [
      entry.height,
      entry.weight,
      entry.grasa_corporal,
      entry.masa_muscular,
      entry.liquido_corporal
    ]);

    const seriesData = radarValues.map((val, idx) => ({
      value: val,
      name: chartData[idx].fecha
    }));

    const option = {
      title: {
        text: 'Comparación corporal',
        left: 'center'
      },
      tooltip: {},
      radar: {
        indicator: labels.map(label => ({ name: label, max: 200 })),
        shape: 'circle'
      },
      series: [{
        type: 'radar',
        data: seriesData
      }]
    };

    const myChart = echarts.init(document.getElementById('main'));
    myChart.setOption(option);
  } else {
    document.getElementById('main').innerHTML = '<p style="text-align:center;">No hay mediciones para mostrar.</p>';
  }
</script>


  <footer class="footer">
    <div class="footer-left">
      <img src="{% static 'images/logo.png' %}" alt="Logo" class="logo">
      <div class="social-icons">
        <a href="https://www.facebook.com/ZukaKhantadze" target="_blank" aria-label="Facebook">
          <i class="fab fa-facebook-f"></i>
        </a>
        <a href="https://www.tiktok.com/@_zakhan_" target="_blank" aria-label="TikTok">
          <i class="fab fa-tiktok"></i>
        </a>
        <a href="https://www.instagram.com/_zakhan_" target="_blank" aria-label="Instagram">
          <i class="fab fa-instagram"></i>
        </a>
      </div>
    </div>
    <div class="footer-columns">
      <div class="footer-column">
        <h4>Contacto</h4>
        <p>contacto@fittracker.com</p>
        <p>+34 012 456 789</p>
      </div>
      <div class="footer-column">
        <h4>Dirección</h4>
        <p>Calle Inexistente 13</p>
        <p>Madrid, España</p>
      </div>
      <div class="footer-column">
        <h4>Redes Sociales</h4>
        <p>Síguenos en Facebook, <br>TikTok e Instagram.</p>
      </div>
    </div>
  </footer>
</body>
</html>
